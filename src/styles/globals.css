@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  :root {
    --font-serif: "Playfair Display", "Merriweather", serif;
    --font-sans: "Inter", "Roboto", sans-serif;
    --font-mono: "JetBrains Mono", monospace;
    --color-ink: #1a1a1a;
    --color-paper: #fafafa;
    --color-accent: #dc2626;
    --color-gray: #6b7280;
  }

  /* View Transitions API for smooth theme switching */
  ::view-transition-old(root),
  ::view-transition-new(root) {
    animation-duration: 0.5s;
  }

  html {
    font-size: 16px;
    scroll-behavior: smooth;
  }

  body {
    @apply bg-newspaper-paper text-newspaper-ink font-sans antialiased;
    min-height: -webkit-fill-available;
  }

  .dark body {
    @apply bg-zinc-900 text-zinc-100;
  }

  ::selection {
    @apply bg-newspaper-accent text-newspaper-paper;
  }

  .dark ::selection {
    @apply bg-red-400 text-zinc-900;
  }
}

@layer components {
  a {
    @apply underline-offset-4 transition-colors duration-150 ease-out;
  }

  a:hover {
    @apply text-newspaper-accent dark:text-red-400;
  }

  .dropcap:first-letter {
    @apply float-left mr-3 mt-1 text-6xl font-serif font-bold leading-none text-newspaper-accent dark:text-red-400;
  }

  .prose {
    @apply max-w-prose;
  }

  .prose img {
    @apply rounded-none border border-black/5 shadow-editorial dark:border-white/5;
    max-width: 100%;
    height: auto;
  }

  .prose figure {
    @apply my-8;
    max-width: 100%;
    overflow-x: auto;
  }

  .prose figcaption {
    @apply mt-3 text-sm font-serif uppercase tracking-[0.22em] text-newspaper-gray dark:text-zinc-400;
  }

  .prose pre {
    max-width: 100%;
    overflow-x: auto;
  }

  .prose code {
    word-wrap: break-word;
    overflow-wrap: break-word;
  }

  .prose table {
    display: block;
    max-width: 100%;
    overflow-x: auto;
  }

  .sr-only-focusable:focus {
    @apply not-sr-only absolute left-4 top-4 inline-flex items-center rounded bg-newspaper-ink px-3 py-2 text-sm font-semibold tracking-wide text-newspaper-paper shadow-lg focus:outline-none focus:ring-2 focus:ring-newspaper-accent dark:bg-zinc-100 dark:text-zinc-900 dark:focus:ring-red-400;
  }

  /* Archive loading animation */
  .archive-loader {
    width: fit-content;
    font-size: 40px;
    font-family: var(--font-serif);
    font-weight: bold;
    text-transform: uppercase;
    color: transparent;
    -webkit-text-stroke: 1px var(--color-ink);
    background: conic-gradient(var(--color-ink) 0 0) text;
    -webkit-background-clip: text;
    background-clip: text;
    animation: archive-loading 2s linear infinite;
  }

  .archive-loader::before {
    content: "Loading";
  }

  .dark .archive-loader {
    -webkit-text-stroke: 1px theme('colors.zinc.100');
    background: conic-gradient(theme('colors.zinc.100') 0 0) text;
    -webkit-background-clip: text;
    background-clip: text;
  }

  @keyframes archive-loading {
    0%, 2%, 8%, 11%, 15%, 21%, 30%, 32%, 35%, 40%, 46%, 47%, 53%, 61%, 70%, 72%, 77%, 80%, 86% {
      background-size: 0 0;
    }
    1%, 9%, 10%, 16%, 20%, 31%, 34%, 41%, 45%, 48%, 52%, 55%, 60%, 73%, 76%, 81%, 85%, 96%, 100% {
      background-size: 100% 100%;
    }
  }
}

@layer utilities {
  /* Enable smooth transitions for all interactive elements */
  * {
    transition-property: color, background-color, border-color, text-decoration-color, fill, stroke, transform, box-shadow, opacity;
    transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
    transition-duration: 200ms;
  }

  /* Hardware acceleration for smoother transforms and prevent glitches */
  img,
  [class*="hover:-translate"],
  [class*="hover:scale"],
  [class*="group-hover:scale"],
  [class*="hover:shadow"] {
    -webkit-transform: translateZ(0);
    transform: translateZ(0);
    -webkit-backface-visibility: hidden;
    backface-visibility: hidden;
    -webkit-perspective: 1000px;
    perspective: 1000px;
  }
}
